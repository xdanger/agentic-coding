# 002. 实现文档标准检查工具

日期: 2025-03-19
作者: 团队
状态: 已接受

## 背景和问题陈述

随着 Agentic Coding 框架的发展，我们已经制定了详细的文档标准（见 `/docs/specs/documentation-standards.md`）。然而，仅有标准而无法自动验证，不足以确保所有文档都一致地遵循这些标准。特别是在以下几个方面，我们发现了不一致的情况：

1. 文件和目录命名不一致（如有些使用下划线，有些使用连字符）
2. 文件路径引用缺少反引号包围
3. 代码块没有指定语言或使用不适当的语言标签
4. Markdown 结构不一致（标题层级不连贯，列表标记不统一）

这些不一致不仅影响了文档的可读性，还可能导致 AI 在处理文档时出现混淆，影响工作效率。

## 考虑的方案

### 方案 1: 手动检查和导览

这个方案依赖于人工审查来确保文档符合标准。

优点:

- 无需额外的工具
- 可以基于上下文进行灵活的判断

缺点:

- 耗时且容易出错
- 随着项目增长变得不可行
- 容易忽略细节问题
- 难以在 CI/CD 过程中集成

### 方案 2: 使用现有的 Markdown 检查工具

使用现有的开源 Markdown 检查工具，如 markdownlint。

优点:

- 成熟的工具，功能丰富
- 社区支持好
- 易于集成到 CI/CD 流程中

缺点:

- 不完全符合我们特有的文档标准
- 配置复杂，可能需要大量定制
- 可能无法检查特定的文件引用格式要求

### 方案 3: 开发自定义文档标准检查工具

开发一个专门针对我们的文档标准的检查工具。

优点:

- 完全符合我们的特定标准
- 可以精确检查文件引用格式、目录命名规范等
- 易于与我们的工作流集成
- 可以根据需求不断完善和扩展

缺点:

- 需要开发和维护
- 初始投入较大
- 可能存在边缘情况未被覆盖

## 决策结果

我们选择了方案 3，开发自定义文档标准检查工具，因为它最能满足我们的特定需求，并且可以随着项目的发展而调整。该工具将具备以下功能：

1. 检查文件和目录命名是否符合规范（小写，连字符分隔，集合用复数）
2. 检查文件引用格式（使用反引号包围）
3. 检查代码块格式（指定语言，纯文本使用 plaintext）
4. 检查 Markdown 结构（标题层级，列表样式）

工具将由 Python 实现，并提供以下接口：

```plaintext
# 检查所有文档
./utils/lint_docs.sh

# 检查特定文档
./utils/lint_docs.sh --file path/to/your/document.md

# 严格模式（将警告视为错误）
./utils/lint_docs.sh --strict
```

此外，我们将在 GitHub Actions 中集成该工具，确保所有提交的文档变更都符合规范。

## 实施计划

实施将分为以下几个步骤：

1. 开发核心检查逻辑，实现各项检查规则
2. 创建命令行接口，支持各种参数选项
3. 编写便捷的 shell 脚本，便于在本地运行
4. 配置 GitHub Actions 工作流，实现自动检查
5. 创建详细的使用文档，介绍工具的功能和使用方法
6. 在几个现有文档上测试工具，验证其有效性
7. 对所有现有文档运行工具，修复不符合规范的问题

## 回顾和验证

我们将通过以下方式评估文档标准检查工具的有效性：

1. 检查工具是否能够准确识别各种不符合规范的情况
2. 监测误报率和漏报率
3. 收集使用者的反馈，了解工具的易用性
4. 观察文档质量的提升情况

基于这些评估，我们将不断完善工具的功能和性能，确保它能够有效地帮助维护文档标准。
